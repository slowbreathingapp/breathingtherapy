<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Advanced Deep Breath Guide (3 BPM)</title>    <script src="https://cdn.tailwindcss.com"></script>    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">    <style>        /*        New Cycle: 5s Inhale + 5s Hold + 10s Exhale = 20 seconds        60 seconds / 20 seconds = 3 breaths per minute (3 BPM)        */        :root {            --inhale-duration: 5s;   /* Changed from 4s */            --hold-duration: 5s;     /* Changed from 2s */            --exhale-duration: 10s;  /* Changed from 6s */            --cycle-duration: calc(var(--inhale-duration) + var(--exhale-duration) + var(--hold-duration));        }        body {            font-family: 'Inter', sans-serif;            min-height: 100vh;            background-color: #f7f7f7;            display: flex;            justify-content: center;            align-items: center;            padding: 20px;        }        .breather-circle {            width: 150px;            height: 150px;            background: linear-gradient(135deg, #4f46e5, #8b5cf6);            border-radius: 50%;            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);            transform: scale(1);            transition: none;             will-change: transform;            opacity: 0.8;            display: flex;            justify-content: center;            align-items: center;            position: relative;        }        .breather-circle.inhale {            /* Smoothly transitions from current state to max size (1.5) */            transition: transform var(--inhale-duration) ease-in, opacity var(--inhale-duration) ease-in;             transform: scale(1.5);            opacity: 1;        }        .breather-circle.exhale {            /* Smoothly transitions from max size (1.5) to min size (1) */            transition: transform var(--exhale-duration) ease-out, opacity var(--exhale-duration) ease-out;            transform: scale(1);            opacity: 0.8;        }        .breather-circle.hold {            /* Stays at maximum size during hold without animation */            transition: none;            transform: scale(1.5);             opacity: 1;        }                .breather-circle-inner {            color: white;            font-size: 1.25rem;            font-weight: 600;            text-align: center;            transition: opacity 0.5s;        }        /* Responsive adjustments */        @media (max-width: 640px) {            .breather-circle {                width: 120px;                height: 120px;            }        }    </style></head><body class="bg-gray-100">    <div id="app" class="max-w-md w-full bg-white p-6 md:p-8 rounded-xl shadow-2xl flex flex-col items-center space-y-8">                <h1 class="text-3xl font-bold text-gray-800 tracking-tight">Deep Breath Guide (3 BPM)</h1>                <!-- Breathing Animation Area -->        <div class="flex flex-col items-center space-y-6">            <div id="breather" class="breather-circle">                <div id="instruction" class="breather-circle-inner">Start</div>            </div>            <div class="text-center">                <p id="timer" class="text-xl font-mono text-indigo-600">00:00</p>                <!-- Updated display to reflect the new 20-second cycle -->                <p class="text-sm text-gray-500 mt-1">5s Inhale / 5s Hold / 10s Exhale (3 Breaths/min)</p>            </div>        </div>        <!-- Controls -->        <div class="flex space-x-4">            <button id="startButton" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">                Start Breathing            </button>            <button id="stopButton" class="px-6 py-3 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 transition duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2" disabled>                Stop            </button>        </div>        <!-- Simulated Vitals Monitoring (Addressing the Apple Watch Request) -->        <div class="w-full pt-6 border-t border-gray-200 mt-6 space-y-4">            <h2 class="text-xl font-semibold text-gray-700">Simulated Vitals Check</h2>            <div class="flex flex-col sm:flex-row gap-4">                <input type="number" id="heartRateInput" placeholder="Enter Current HR (BPM)" value="75" min="40" max="150" class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">                <button id="checkVitalsButton" class="px-4 py-3 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition duration-200">                    Check Vitals                </button>            </div>                        <p id="vitalsFeedback" class="text-base font-medium text-gray-600"></p>        </div>    </div>    <script>        // Global variables for Firebase configuration (unused in this simple app, but maintained)        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;        // --- Core Breathing Logic ---        // NEW TIMINGS for 3 Breaths Per Minute (20 second cycle)        const INHALE_DURATION_MS = 5000;        const HOLD_DURATION_MS = 5000;         const EXHALE_DURATION_MS = 10000;         const CYCLE_TOTAL_MS = INHALE_DURATION_MS + HOLD_DURATION_MS + EXHALE_DURATION_MS; // 20000ms                const breather = document.getElementById('breather');        const instruction = document.getElementById('instruction');        const timerDisplay = document.getElementById('timer');        const startButton = document.getElementById('startButton');        const stopButton = document.getElementById('stopButton');        const checkVitalsButton = document.getElementById('checkVitalsButton');        const heartRateInput = document.getElementById('heartRateInput');        const vitalsFeedback = document.getElementById('vitalsFeedback');        let intervalId = null;        let runningTime = 0;        let isRunning = false;        let animationTimeout = null;        const STATE = {            IDLE: 'IDLE',            INHALE: 'INHALE',            HOLD: 'HOLD',             EXHALE: 'EXHALE'        };        let currentState = STATE.IDLE;        function updateInstruction(text) {            instruction.textContent = text;        }        function setBreatherClass(newState) {            // Reset all state classes            breather.classList.remove('inhale', 'exhale', 'hold');                         if (newState === STATE.INHALE) {                breather.classList.add('inhale');            } else if (newState === STATE.HOLD) {                breather.classList.add('hold');            } else if (newState === STATE.EXHALE) {                breather.classList.add('exhale');            }        }        function startInhale() {            currentState = STATE.INHALE;            updateInstruction('Inhale (5s)');            setBreatherClass(STATE.INHALE);                        // Next step is Hold            animationTimeout = setTimeout(startHold, INHALE_DURATION_MS);        }        function startHold() {            currentState = STATE.HOLD;            updateInstruction('Hold (5s)');            setBreatherClass(STATE.HOLD);                        // Next step is Exhale            animationTimeout = setTimeout(startExhale, HOLD_DURATION_MS);        }        function startExhale() {            currentState = STATE.EXHALE;            updateInstruction('Exhale (10s)');            setBreatherClass(STATE.EXHALE);                        // Next step is Inhale (Loop)            animationTimeout = setTimeout(startInhale, EXHALE_DURATION_MS);         }        function startBreathingCycle() {            if (isRunning) return;            isRunning = true;            runningTime = 0;            startButton.disabled = true;            stopButton.disabled = false;            heartRateInput.disabled = true;            checkVitalsButton.disabled = true;            // Start the breathing animation            startInhale();             // Start the session timer            intervalId = setInterval(() => {                runningTime += 1000;                const minutes = String(Math.floor(runningTime / 60000)).padStart(2, '0');                const seconds = String(Math.floor((runningTime % 60000) / 1000)).padStart(2, '0');                timerDisplay.textContent = `${minutes}:${seconds}`;            }, 1000);        }        function stopBreathingCycle() {            isRunning = false;            currentState = STATE.IDLE;                        // Clear all timers and timeouts            clearInterval(intervalId);            clearTimeout(animationTimeout);                        // Reset UI state            updateInstruction('Ready');            breather.className = 'breather-circle'; // Reset to base state (scale 1)                        startButton.disabled = false;            stopButton.disabled = true;            heartRateInput.disabled = false;            checkVitalsButton.disabled = false;        }                startButton.addEventListener('click', startBreathingCycle);        stopButton.addEventListener('click', stopBreathingCycle);        // --- Simulated Vitals Logic ---        // Assume High Rate is above 95 BPM and Low Rate is below 50 BPM for a resting/calm state        const HR_HIGH_THRESHOLD = 95;         const HR_LOW_THRESHOLD = 50;        function checkVitals() {            const hr = parseInt(heartRateInput.value, 10);                        if (isNaN(hr) || hr < 0) {                vitalsFeedback.textContent = "Please enter a valid heart rate.";                vitalsFeedback.classList.remove('text-red-500', 'text-green-600', 'text-indigo-600');                vitalsFeedback.classList.add('text-gray-600');                return;            }            if (hr > HR_HIGH_THRESHOLD) {                vitalsFeedback.textContent = `?? High Heart Rate Detected (${hr} BPM). Starting Mindful Breathing now!`;                vitalsFeedback.classList.remove('text-green-600', 'text-indigo-600');                vitalsFeedback.classList.add('text-red-500');                if (!isRunning) {                    startBreathingCycle();                }            } else if (hr < HR_LOW_THRESHOLD) {                vitalsFeedback.textContent = `?? Low Heart Rate Detected (${hr} BPM). Please consult a medical professional if you feel unwell.`;                vitalsFeedback.classList.remove('text-red-500', 'text-green-600');                vitalsFeedback.classList.add('text-indigo-600');                if (isRunning) {                    stopBreathingCycle();                }            } else {                vitalsFeedback.textContent = `Heart Rate is Optimal (${hr} BPM). Keep it up!`;                vitalsFeedback.classList.remove('text-red-500', 'text-indigo-600');                vitalsFeedback.classList.add('text-green-600');            }        }                checkVitalsButton.addEventListener('click', checkVitals);                // Initial state setup on load        window.onload = function() {            updateInstruction('Ready');            // Check vitals on load with the default input value            checkVitals();        };            </script></body></html>